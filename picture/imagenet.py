import matplotlib.pyplot as plt
import numpy as np

resnet18_on_imagenet_accuracy = [0.08653846153846154, 0.1558801775147929, 0.20377218934911243, 0.23502218934911243,
                                 0.2559171597633136, 0.26127958579881655, 0.27403846153846156, 0.25018491124260356,
                                 0.26645710059171596, 0.3522559171597633, 0.3191568047337278, 0.32581360946745563,
                                 0.29400887573964496, 0.33505917159763315, 0.29659763313609466, 0.2938239644970414,
                                 0.3328402366863905, 0.33136094674556216, 0.3311760355029586, 0.36335059171597633,
                                 0.3496671597633136, 0.3265532544378698, 0.3724112426035503, 0.36778846153846156,
                                 0.3352440828402367, 0.3557692307692308, 0.3193417159763314, 0.35336538461538464,
                                 0.363905325443787, 0.3443047337278107, 0.37259615384615385, 0.36519970414201186,
                                 0.3692677514792899, 0.44914940828402367, 0.47928994082840237, 0.4885355029585799,
                                 0.47152366863905326, 0.48409763313609466, 0.4694896449704142, 0.4870562130177515,
                                 0.4885355029585799, 0.4996301775147929, 0.4996301775147929, 0.4595044378698225,
                                 0.476146449704142, 0.48298816568047337, 0.4693047337278107, 0.5105399408284024,
                                 0.5061020710059172, 0.4443417159763314, 0.4680103550295858, 0.4779955621301775,
                                 0.5199704142011834, 0.5012943786982249, 0.520155325443787, 0.47744082840236685,
                                 0.5240384615384616, 0.49907544378698226, 0.4996301775147929, 0.4839127218934911,
                                 0.5018491124260355, 0.511094674556213, 0.49019970414201186, 0.5919008875739645,
                                 0.5924556213017751, 0.5780325443786982, 0.6137204142011834, 0.5822855029585798,
                                 0.5741494082840237, 0.5961538461538461, 0.5730399408284024, 0.5998520710059172,
                                 0.606508875739645, 0.584689349112426, 0.5963387573964497, 0.6033653846153846,
                                 0.595784023668639, 0.6832470414201184, 0.6963757396449705, 0.6776997041420119,
                                 0.6532914201183432, 0.6788091715976331, 0.6732618343195266, 0.6601331360946746,
                                 0.6701183431952663, 0.6749260355029586, 0.674741124260355, 0.6776997041420119,
                                 0.6813979289940828, 0.7324334319526628, 0.7326183431952663, 0.7407544378698225,
                                 0.7320636094674556, 0.7231878698224852, 0.7316937869822485, 0.7276257396449705,
                                 0.727810650887574, 0.7265162721893491, 0.7144970414201184, 0.7200443786982249,
                                 0.7267011834319527, 0.7696005917159763, 0.7736686390532544, 0.7655325443786982,
                                 0.7671967455621301, 0.7538831360946746, 0.7673816568047337, 0.7531434911242604,
                                 0.7720044378698225, 0.7607248520710059, 0.7601701183431953, 0.7657174556213018,
                                 0.7941937869822485, 0.7904955621301775, 0.786612426035503, 0.7871671597633136,
                                 0.783284023668639, 0.7871671597633136, 0.7914201183431953, 0.7821745562130178]
resnet18_on_imagenet_train_loss = [4.296002573201686, 3.8273356627240593, 3.5067679139125496, 3.330346966927925,
                                   3.2110795993569456, 3.127627644990207, 3.0529735976482124, 2.997489157429448,
                                   2.947814806518241, 2.8976526271364818, 2.8615192551475492, 2.836964348765558,
                                   2.809701998950032, 2.7813577535024887, 2.7579626926767484, 2.7465589441684046,
                                   2.7303963989681668, 2.7280552143128323, 2.7084282825218797, 2.6978466128125604,
                                   2.6767954429971828, 2.6689934870245033, 2.668803192499734, 2.6676974822856763,
                                   2.6551413336702825, 2.641621249516805, 2.6350671287426732, 2.63606395168069,
                                   2.630823836385468, 2.6194532362620038, 2.6168688586121234, 2.6223310349311357,
                                   2.6167802838925964, 2.251029187347663, 2.2355826525433073, 2.2383849552138844,
                                   2.221018716513865, 2.2052226414307645, 2.2017744666362495, 2.1894332944218515,
                                   2.181483328430741, 2.1718552674187555, 2.1589743417967493, 2.156427439387443,
                                   2.156119382293136, 2.14786292633402, 2.144894306355543, 2.144650602929386,
                                   2.132977595133055, 2.1242577278466874, 2.141701558627219, 2.1200074133853364,
                                   2.1228338850084154, 2.122334301952472, 2.116185739167924, 2.11125457288797,
                                   2.111390111750536, 2.1166782337549783, 2.1092721451260914, 2.10397922716023,
                                   2.1023267904917398, 2.098371877356321, 2.107114947205218, 1.7600902191797891,
                                   1.741307013594074, 1.760843844178282, 1.7601909450052207, 1.7561019755783396,
                                   1.7515628801746133, 1.7504027436299578, 1.739147348874881, 1.746860566963384,
                                   1.730683529681139, 1.7396597458207559, 1.7285787107522597, 1.7179520996509756,
                                   1.7186824262681812, 1.4297857695253788, 1.3978760254039686, 1.4073998368620382,
                                   1.4153589987068018, 1.4125861696549404, 1.4100017335091108, 1.4114142743844553,
                                   1.397476219169397, 1.4010819913526622, 1.3992073234314781, 1.3915320909170457,
                                   1.3965678302348887, 1.1606315771934916, 1.1089504098303524, 1.110014361511042,
                                   1.1044703707086696, 1.0993663319834956, 1.1106291447941659, 1.1176634843555497,
                                   1.1084682061250317, 1.110186873012119, 1.0977159593723438, 1.1094605036919991,
                                   1.103067974229899, 0.9271788494184675, 0.8722485517964932, 0.8646867822227164,
                                   0.8558337636739629, 0.8424379035474833, 0.8467975399327377, 0.8569440647211585,
                                   0.8412650603718228, 0.8409365808816603, 0.8432525891531643, 0.8436097214349504,
                                   0.7160424315782241, 0.6869643419367786, 0.6649767437687627, 0.6570004295566936,
                                   0.6658968500149103, 0.6539321705147072, 0.6422322765495552, 0.6357506403510953]
resnet18_on_imagenet_val_loss = [4.013184226353963, 3.5610653022483545, 3.2934972031911216, 3.1401538831216316,
                                 3.017395491776643, 3.05438021518566, 2.9380042288038464, 3.1696252455534757,
                                 3.037539055435746, 2.558744137375443, 2.750444219024093, 2.6954558460800735,
                                 2.9049346616533067, 2.6471926268824824, 2.8076230066793935, 3.160246814445213,
                                 2.6375902829346836, 2.7971279147819237, 2.6989168583905254, 2.5183224851113777,
                                 2.5858240237059418, 2.790562340418498, 2.4672245975776956, 2.5034467015443025,
                                 2.736616267804746, 2.5702647580040825, 2.921918020248413, 2.519230386592724,
                                 2.5356905976048223, 2.7251486965462015, 2.523231555444223, 2.488531809559575,
                                 2.5091848009603996, 2.1914155536227757, 2.0035341656649552, 1.9662563422874169,
                                 2.0307337577254683, 2.066542930603027, 2.119869082238939, 2.0276296456654865,
                                 2.019580363344263, 1.929207206302219, 1.9235847625025997, 2.1154201475779217,
                                 2.081763100800691, 2.007152466420774, 2.0616791039926032, 1.8965678856107924,
                                 1.8830360924756084, 2.176765249040392, 2.269651213751899, 2.0046810708222567,
                                 1.8157891026249637, 1.9408340097356727, 1.842575493565312, 2.0412870772679645,
                                 1.846832408728423, 1.9919793457455106, 1.9616066876164189, 2.020958812854908,
                                 1.9353179747970015, 1.8819436491860284, 1.975380618483932, 1.549105685463658,
                                 1.5524428005571718, 1.6298010200924344, 1.4778158609955399, 1.5708161384088022,
                                 1.612277275721232, 1.5424303630546288, 1.5775745994073374, 1.5340849924087525,
                                 1.5066799102006134, 1.5778497346242268, 1.5170614912774827, 1.5043388294290614,
                                 1.512470643873568, 1.1800853380450496, 1.113670311415637, 1.1574482700559827,
                                 1.3067443796440408, 1.164286213097749, 1.212663319464083, 1.2773658030121415,
                                 1.2378823536413688, 1.226219944689009, 1.1935752409475822, 1.2136991556485495,
                                 1.1551679299495838, 0.9887103465751366, 0.9719309441248576, 0.9781211013264126,
                                 0.9764965331112897, 1.0125908483399286, 0.9903493430879381, 1.0309175756242541,
                                 1.006877222944189, 1.0127142016092936, 1.0679939386579727, 1.0314072988651417,
                                 1.002178448482796, 0.8359258697651051, 0.8475060943320946, 0.858270449814973,
                                 0.8461482640548988, 0.8954989417394003, 0.8438923190258167, 0.9059848222026119,
                                 0.8412289640638564, 0.8748023168245951, 0.873859225820612, 0.8796623943470142,
                                 0.7646276501373008, 0.7585478830337524, 0.7750860857963562, 0.7736216626343904,
                                 0.7757383825160838, 0.7845522738386084, 0.7821006925900778, 0.7970020993550618]

plain18_on_imagenet_accuracy = [0.05661764705882353, 0.09889705882352941, 0.1323529411764706, 0.15625,
                                0.14595588235294119, 0.17628676470588237, 0.19595588235294117, 0.1895220588235294,
                                0.2369485294117647, 0.21709558823529412, 0.196875, 0.20441176470588235,
                                0.2584558823529412, 0.2443014705882353, 0.3034926470588235, 0.29503676470588236,
                                0.3220588235294118, 0.3251838235294118, 0.3420955882352941, 0.3125, 0.3400735294117647,
                                0.32224264705882355, 0.32279411764705884, 0.325, 0.3492647058823529,
                                0.33253676470588234, 0.3040441176470588, 0.303125, 0.3584558823529412,
                                0.3301470588235294, 0.3, 0.35606617647058825, 0.32279411764705884, 0.29411764705882354,
                                0.33345588235294116, 0.3386029411764706, 0.33455882352941174, 0.375,
                                0.34705882352941175, 0.37996323529411763, 0.3235294117647059, 0.2615808823529412,
                                0.34154411764705883, 0.328125, 0.3961397058823529, 0.3963235294117647,
                                0.37977941176470587, 0.32683823529411765, 0.39595588235294116, 0.2702205882352941,
                                0.27536764705882355, 0.3724264705882353, 0.35073529411764703, 0.3380514705882353,
                                0.29669117647058824, 0.48933823529411763, 0.4965073529411765, 0.4608455882352941,
                                0.49172794117647056, 0.48400735294117647, 0.4297794117647059, 0.48198529411764707,
                                0.5066176470588235, 0.4470588235294118, 0.47794117647058826, 0.5091911764705882,
                                0.4994485294117647, 0.44136029411764705, 0.4818014705882353, 0.5102941176470588,
                                0.4391544117647059, 0.49963235294117647, 0.43731617647058824, 0.4319852941176471,
                                0.5066176470588235, 0.5189338235294118, 0.47702205882352944, 0.4511029411764706,
                                0.49301470588235297, 0.4702205882352941, 0.5198529411764706, 0.5297794117647059,
                                0.46433823529411766, 0.5090073529411765, 0.5136029411764705, 0.5044117647058823,
                                0.4020220588235294, 0.4988970588235294, 0.484375, 0.5238970588235294,
                                0.5454044117647059, 0.49117647058823527, 0.6292279411764706, 0.5977941176470588,
                                0.6113970588235295, 0.5987132352941177, 0.6086397058823529, 0.5737132352941177,
                                0.5871323529411765, 0.590625, 0.6058823529411764, 0.5908088235294118,
                                0.5963235294117647, 0.6753676470588236, 0.6875, 0.6933823529411764, 0.6777573529411764,
                                0.6849264705882353, 0.6637867647058824, 0.6659926470588236, 0.6630514705882353,
                                0.6715073529411765, 0.6803308823529411, 0.6544117647058824, 0.6722426470588235,
                                0.7356617647058824, 0.7297794117647058, 0.7318014705882353, 0.7330882352941176,
                                0.7235294117647059]
plain18_on_imagenet_train_loss = [4.324726642483056, 4.038518282022986, 3.8080135970253024, 3.63996533904056,
                                  3.487836114349679, 3.3668088664537597, 3.257224715393757, 3.176258990872544,
                                  3.1078808591787705, 3.0501142196105833, 2.99173018942154, 2.936693385442098,
                                  2.9039899973614225, 2.856863306814751, 2.8146443947058155, 2.7826836837564475,
                                  2.757520566280977, 2.729617945981124, 2.6878728096180984, 2.6928803246502033,
                                  2.659401952641491, 2.644700075785319, 2.6266618233747443, 2.6067696059976586,
                                  2.596392908802739, 2.577569227140136, 2.5633761400450403, 2.5532094666202374,
                                  2.5405182254854055, 2.544550694791378, 2.5265020543950083, 2.51971096458749,
                                  2.506675002957568, 2.5060389623131774, 2.496309914922518, 2.5006525817133274,
                                  2.49093127074065, 2.4746782237315865, 2.478566800419686, 2.4665239577430755,
                                  2.4615307398588078, 2.4619598919668317, 2.447556646723806, 2.4555595472908807,
                                  2.4537522102874, 2.441638860820252, 2.4414450555573763, 2.433811754572048,
                                  2.4334537500216635, 2.4406591603785386, 2.4396159692458164, 2.436811269752283,
                                  2.4225724282284333, 2.4257318040274787, 2.4276376548814187, 2.0518757004600494,
                                  2.0277393683288323, 2.052728437926053, 2.035939307997747, 2.028954746576003,
                                  2.0214282364707916, 2.003612401318648, 2.007537883888056, 2.0076047164226267,
                                  1.993005631136796, 1.9925035202356032, 1.973878546938484, 1.965470599794584,
                                  1.957861041198542, 1.9531481593528401, 1.9453114781163847, 1.9567375197233978,
                                  1.943975570545275, 1.935922880290467, 1.9425198360725686, 1.9200237531426512,
                                  1.9394494791384096, 1.9239063953274071, 1.9193039403138337, 1.9179373626552,
                                  1.9068103757316683, 1.9126291402573448, 1.9142990510650133, 1.903285165362888,
                                  1.9058207734425863, 1.895529411987022, 1.8945222064595164, 1.8870349766688093,
                                  1.8942349097561935, 1.878564393118085, 1.8915208172307583, 1.889017626326761,
                                  1.5565338191083429, 1.505904952724284, 1.5119868548514912, 1.5179051301705004,
                                  1.5135165145465868, 1.5244514894681702, 1.5246854748156826, 1.5222543305722773,
                                  1.5146747355402252, 1.5089495615115383, 1.5115110910870901, 1.2417733121310732,
                                  1.1953319914743243, 1.1768503661607028, 1.1867025170502838, 1.176297205269582,
                                  1.178839630374202, 1.1840681861948084, 1.1763779431409798, 1.1732409107341688,
                                  1.1660295981929136, 1.1747850277001965, 1.1670389275688202, 0.9725404785886222,
                                  0.9168179375644574, 0.8989077272729128, 0.8883114480383603, 0.8830337615268221]
plain18_on_imagenet_val_loss = [4.180729181501601, 3.923720705244276, 3.683633178428367, 3.6164601869936344,
                                3.5823994145569977, 3.5260103377589473, 3.355402442437631, 3.4578927117806892,
                                3.110589547333894, 3.283762249416775, 3.499374160413389, 3.370700311660767,
                                3.092927226667051, 3.3027563826243083, 2.7554250770144995, 2.8861672729916044,
                                2.722997590170966, 2.6727914103755244, 2.646435740082352, 2.8223709993009214,
                                2.6692203380443433, 2.734300291273329, 2.7240056970384385, 2.7100840052851924,
                                2.5903830641287344, 2.7171555536764638, 2.859564042267976, 2.990395865970188,
                                2.585347630536115, 2.6965675406985814, 2.8670823220853454, 2.596627490785387,
                                2.834451797273424, 2.9623187142831306, 2.675379715319033, 2.6862634598767317,
                                2.7157228992603444, 2.510514609372174, 2.5994010176482023, 2.5360161428098325,
                                2.8252484706596093, 3.3525998097878915, 2.658754636093422, 2.6805322470488373,
                                2.351989758456195, 2.420054134439539, 2.475116777773257, 2.8072120327419703,
                                2.369164774859393, 3.159702245924208, 3.1282574000181973, 2.4916081163618298,
                                2.6632518404501457, 2.893237018938418, 3.01770495556019, 1.9401131771228932,
                                1.9155776098039414, 2.076350799489904, 1.9727642419603135, 2.0036579642472443,
                                2.232357324670862, 1.9707051706314087, 1.8898814773559571, 2.1565131876203747,
                                2.0039558686150443, 1.8876690744470668, 1.923109895741498, 2.2154595846600005,
                                1.9672747226997658, 1.8677049523812752, 2.192926211533723, 1.9420754593390006,
                                2.2067514285334835, 2.3018907515207925, 1.928111581625762, 1.833709612775732,
                                2.0824148626680725, 2.2093003311863653, 2.004016606366193, 2.051143161985609,
                                1.8739456741898148, 1.7634210701341981, 2.131052464025992, 1.932122248367027,
                                1.8790767417130647, 1.9445060948972348, 2.5828107088583487, 1.9560994370778402,
                                2.002416389606617, 1.8643608086197465, 1.7693149849220557, 1.9585945638020834,
                                1.3902918921576606, 1.527847821270978, 1.444041924300017, 1.4767417877691764,
                                1.4683189282593905, 1.6036271367249666, 1.5639781671100192, 1.5395191814281322,
                                1.5010396125581529, 1.5976499790615506, 1.557678793447989, 1.234423235434073,
                                1.1294129120862042, 1.1346186312922726, 1.1923697576699432, 1.1769155503202369,
                                1.251031969300023, 1.2441430349703189, 1.2716667924986946, 1.2041087129380967,
                                1.17497404716633, 1.2675831623430605, 1.2329816369657163, 0.9632346508238051,
                                0.9725840988865605, 0.974644706690753, 0.9926765181400158, 1.0118727032343546]
plt.rcParams['axes.unicode_minus'] = False  # 解决负号显示为方块的问题
plt.rcParams['font.sans-serif'] = ['SimHei']

fontdict = {'weight': 'normal', 'family': 'Times New Roman', 'size': 20}
fig, axes = plt.subplots(1, 3, figsize=(12, 4))
x = np.arange(1, 121)
axes[0].plot(x, resnet18_on_imagenet_accuracy, 'g', label="resnet18")
axes[0].plot(x, plain18_on_imagenet_accuracy, 'r', label="plain18")
axes[0].legend()
# 开启网格
axes[0].grid(True)
axes[0].set_title('验证集上的正确率')
axes[0].set_xlabel("训练轮数")
axes[0].set_ylabel("正确率")

axes[1].plot(x, resnet18_on_imagenet_train_loss, 'g', label="resnet18")
axes[1].plot(x, plain18_on_imagenet_train_loss, 'r', label="plain18")
axes[1].legend()
# 开启网格
axes[1].grid(True)
axes[1].set_title('训练集上的loss')
axes[1].set_xlabel("训练轮数")
axes[1].set_ylabel("loss")

axes[2].plot(x, resnet18_on_imagenet_accuracy, 'g', label="resnet18")
axes[2].plot(x, plain18_on_imagenet_accuracy, 'r', label="plain18")
axes[2].legend()
# 开启网格
axes[2].grid(True)
axes[2].set_title('验证集上的loss')
axes[2].set_xlabel("训练轮数")
axes[2].set_ylabel("loss")


# axes[1].plot(x, np.exp(x), 'r')
# # 设置网格的颜色，线型，线宽
# axes[1].grid(color='b', ls='-.', lw=0.25)
# axes[1].set_title('custom grid')
# axes[2].plot(x, x)
# axes[2].set_title('no grid')
fig.tight_layout()
plt.show()

